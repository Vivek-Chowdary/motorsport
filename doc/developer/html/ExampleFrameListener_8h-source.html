<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Motorsport: src/graphics/ExampleFrameListener.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>src/graphics/ExampleFrameListener.h</h1><a href="ExampleFrameListener_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 <span class="comment">/*</span>
00003 <span class="comment">-----------------------------------------------------------------------------</span>
00004 <span class="comment">This source file is part of OGRE</span>
00005 <span class="comment">    (Object-oriented Graphics Rendering Engine)</span>
00006 <span class="comment">For the latest info, see http://www.ogre3d.org/</span>
00007 <span class="comment"></span>
00008 <span class="comment">Copyright © 2000-2002 The OGRE Team</span>
00009 <span class="comment">Also see acknowledgements in Readme.html</span>
00010 <span class="comment"></span>
00011 <span class="comment">This program is free software; you can redistribute it and/or modify it under</span>
00012 <span class="comment">the terms of the GNU Lesser General Public License as published by the Free Software</span>
00013 <span class="comment">Foundation; either version 2 of the License, or (at your option) any later</span>
00014 <span class="comment">version.</span>
00015 <span class="comment"></span>
00016 <span class="comment">This program is distributed in the hope that it will be useful, but WITHOUT</span>
00017 <span class="comment">ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
00018 <span class="comment">FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.</span>
00019 <span class="comment"></span>
00020 <span class="comment">You should have received a copy of the GNU Lesser General Public License along with</span>
00021 <span class="comment">this program; if not, write to the Free Software Foundation, Inc., 59 Temple</span>
00022 <span class="comment">Place - Suite 330, Boston, MA 02111-1307, USA, or go to</span>
00023 <span class="comment">http://www.gnu.org/copyleft/lesser.txt.</span>
00024 <span class="comment">-----------------------------------------------------------------------------</span>
00025 <span class="comment">*/</span>
00026 
00027 <span class="comment">/*</span>
00028 <span class="comment">-----------------------------------------------------------------------------</span>
00029 <span class="comment">Filename:    ExampleFrameListener.h</span>
00030 <span class="comment">Description: Defines an example frame listener which responds to frame events.</span>
00031 <span class="comment">             This frame listener just moves a specified camera around based on</span>
00032 <span class="comment">             keyboard and mousex movements.</span>
00033 <span class="comment">             Mouse:    Freelook</span>
00034 <span class="comment">             W or Up:  Forward</span>
00035 <span class="comment">             S or Down:Backward</span>
00036 <span class="comment">             A:           Step left</span>
00037 <span class="comment">             D:        Step right</span>
00038 <span class="comment">             PgUp:     Move upwards</span>
00039 <span class="comment">             PgDown:   Move downwards</span>
00040 <span class="comment">             O/P:       Yaw the root scene node (and it's children)</span>
00041 <span class="comment">             I/K:       Pitch the root scene node (and it's children)</span>
00042 <span class="comment">             F:           Toggle frame rate stats on/off</span>
00043 <span class="comment">             R:        Render mode</span>
00044 <span class="comment">             T:        Cycle texture filtering</span>
00045 <span class="comment">                       Bilinear, Trilinear, Anisotropic(8)</span>
00046 <span class="comment">-----------------------------------------------------------------------------</span>
00047 <span class="comment">*/</span>
00048 
00049 <span class="preprocessor">#ifndef __ExampleFrameListener_H__</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#define __ExampleFrameListener_H__</span>
00051 <span class="preprocessor"></span>
00052 <span class="preprocessor">#include "Ogre.h"</span>
00053 <span class="preprocessor">#include "OgreKeyEvent.h"</span>
00054 <span class="preprocessor">#include "OgreEventListeners.h"</span>
00055 <span class="preprocessor">#include "OgreStringConverter.h"</span>
00056 <span class="preprocessor">#include "OgreException.h"</span>
00057 
00058 <span class="keyword">using</span> <span class="keyword">namespace </span>Ogre;
00059 
<a name="l00060"></a><a class="code" href="classExampleFrameListener.html">00060</a> <span class="keyword">class </span><a class="code" href="classExampleFrameListener.html">ExampleFrameListener</a>:<span class="keyword">public</span> <a class="code" href="classFrameListener.html">FrameListener</a>, <span class="keyword">public</span> <a class="code" href="classKeyListener.html">KeyListener</a>
00061 {
00062   <span class="keyword">private</span>:
<a name="l00063"></a><a class="code" href="classExampleFrameListener.html#r0">00063</a>     <span class="keywordtype">int</span> <a class="code" href="classExampleFrameListener.html#r0">mSceneDetailIndex</a>;
00064 
<a name="l00065"></a><a class="code" href="classExampleFrameListener.html#d0">00065</a>     <span class="keywordtype">void</span> <a class="code" href="classExampleFrameListener.html#d0">updateStats</a> (<span class="keywordtype">void</span>)
00066     {
00067         <span class="keyword">static</span> String currFps = <span class="stringliteral">"Current FPS: "</span>;
00068         <span class="keyword">static</span> String avgFps = <span class="stringliteral">"Average FPS: "</span>;
00069         <span class="keyword">static</span> String bestFps = <span class="stringliteral">"Best FPS: "</span>;
00070         <span class="keyword">static</span> String worstFps = <span class="stringliteral">"Worst FPS: "</span>;
00071         <span class="keyword">static</span> String tris = <span class="stringliteral">"Triangle Count: "</span>;
00072 
00073         <span class="comment">// update stats when necessary</span>
00074         GuiElement *guiAvg = GuiManager::getSingleton ().getGuiElement (<span class="stringliteral">"Core/AverageFps"</span>);
00075         GuiElement *guiCurr = GuiManager::getSingleton ().getGuiElement (<span class="stringliteral">"Core/CurrFps"</span>);
00076         GuiElement *guiBest = GuiManager::getSingleton ().getGuiElement (<span class="stringliteral">"Core/BestFps"</span>);
00077         GuiElement *guiWorst = GuiManager::getSingleton ().getGuiElement (<span class="stringliteral">"Core/WorstFps"</span>);
00078 
00079         <span class="keyword">const</span> RenderTarget::FrameStats &amp; stats = <a class="code" href="classExampleFrameListener.html#p4">mWindow</a>-&gt;getStatistics ();
00080 
00081           guiAvg-&gt;setCaption (avgFps + StringConverter::toString (stats.avgFPS));
00082           guiCurr-&gt;setCaption (currFps + StringConverter::toString (stats.lastFPS));
00083           guiBest-&gt;setCaption (bestFps + StringConverter::toString (stats.bestFPS) + <span class="stringliteral">" "</span> + StringConverter::toString (stats.bestFrameTime) + <span class="stringliteral">" ms"</span>);
00084           guiWorst-&gt;setCaption (worstFps + StringConverter::toString (stats.worstFPS) + <span class="stringliteral">" "</span> + StringConverter::toString (stats.worstFrameTime) + <span class="stringliteral">" ms"</span>);
00085 
00086         GuiElement *guiTris = GuiManager::getSingleton ().getGuiElement (<span class="stringliteral">"Core/NumTris"</span>);
00087           guiTris-&gt;setCaption (tris + StringConverter::toString (stats.triangleCount));
00088 
00089         GuiElement *guiDbg = GuiManager::getSingleton ().getGuiElement (<span class="stringliteral">"Core/DebugText"</span>);
00090           guiDbg-&gt;setCaption (<a class="code" href="classExampleFrameListener.html#p4">mWindow</a>-&gt;getDebugText ());
00091     }
00092 
00093   <span class="keyword">public</span>:
00094     <span class="comment">// Constructor takes a RenderWindow because it uses that to determine input context</span>
<a name="l00095"></a><a class="code" href="classExampleFrameListener.html#a0">00095</a>       <a class="code" href="classExampleFrameListener.html#a0">ExampleFrameListener</a> (RenderWindow * win, Camera * cam, <span class="keywordtype">bool</span> useBufferedInputKeys = <span class="keyword">false</span>, <span class="keywordtype">bool</span> useBufferedInputMouse = <span class="keyword">false</span>)
00096     {
00097         <a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a> = useBufferedInputKeys;
00098         <a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a> = useBufferedInputMouse;
00099         <a class="code" href="classExampleFrameListener.html#p8">mInputTypeSwitchingOn</a> = <a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a> || <a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a>;
00100 
00101         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p8">mInputTypeSwitchingOn</a>)
00102         {
00103             <a class="code" href="classExampleFrameListener.html#p0">mEventProcessor</a> = <span class="keyword">new</span> EventProcessor ();
00104             <a class="code" href="classExampleFrameListener.html#p0">mEventProcessor</a>-&gt;initialise (win);
00105             OverlayManager::getSingleton ().createCursorOverlay ();
00106             <a class="code" href="classExampleFrameListener.html#p0">mEventProcessor</a>-&gt;startProcessingEvents ();
00107             <a class="code" href="classExampleFrameListener.html#p0">mEventProcessor</a>-&gt;addKeyListener (<span class="keyword">this</span>);
00108             <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a> = <a class="code" href="classExampleFrameListener.html#p0">mEventProcessor</a>-&gt;getInputReader ();
00109 
00110         }
00111         <span class="keywordflow">else</span>
00112         {
00113             <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a> = PlatformManager::getSingleton ().createInputReader ();
00114             <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;initialise (win, <span class="keyword">true</span>, <span class="keyword">true</span>);
00115         }
00116 
00117         <a class="code" href="classExampleFrameListener.html#p2">mCamera</a> = cam;
00118         <a class="code" href="classExampleFrameListener.html#p4">mWindow</a> = win;
00119         <a class="code" href="classExampleFrameListener.html#p5">mStatsOn</a> = <span class="keyword">true</span>;
00120         <a class="code" href="classExampleFrameListener.html#p9">mNumScreenShots</a> = 0;
00121         <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> = 0;
00122         <a class="code" href="classExampleFrameListener.html#r0">mSceneDetailIndex</a> = 0;
00123         <a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a> = 0.0f;
00124         <a class="code" href="classExampleFrameListener.html#p11">mRotScale</a> = 0.0f;
00125         <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a> = Vector3::ZERO;
00126         <a class="code" href="classExampleFrameListener.html#p16">mAniso</a> = 1;
00127         <a class="code" href="classExampleFrameListener.html#p15">mFiltering</a> = TFO_BILINEAR;
00128 
00129         <a class="code" href="classExampleFrameListener.html#a5">showDebugOverlay</a> (<span class="keyword">true</span>);
00130     }
<a name="l00131"></a><a class="code" href="classExampleFrameListener.html#a1">00131</a>     <span class="keyword">virtual</span> <a class="code" href="classExampleFrameListener.html#a1">~ ExampleFrameListener</a> ()
00132     {
00133         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p8">mInputTypeSwitchingOn</a>)
00134         {
00135             <span class="keyword">delete</span> <a class="code" href="classExampleFrameListener.html#p0">mEventProcessor</a>;
00136         }
00137         <span class="keywordflow">else</span>
00138         {
00139             PlatformManager::getSingleton ().destroyInputReader (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>);
00140         }
00141     }
00142 
<a name="l00143"></a><a class="code" href="classExampleFrameListener.html#a2">00143</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classExampleFrameListener.html#a2">processUnbufferedKeyInput</a> (<span class="keyword">const</span> FrameEvent &amp; evt)
00144     {
00145         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_A))
00146         {
00147             <span class="comment">// Move camera left</span>
00148             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.x = -<a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a>;
00149         }
00150 
00151         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_D))
00152         {
00153             <span class="comment">// Move camera RIGHT</span>
00154             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.x = <a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a>;
00155         }
00156 
00157         <span class="comment">/* Move camera forward by keypress. */</span>
00158         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_UP) || <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_W))
00159         {
00160             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.z = -<a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a>;
00161         }
00162         <span class="comment">/* Move camera forward by mousewheel. */</span>
00163         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;getMouseRelativeZ () &gt; 0)
00164         {
00165             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.z = -<a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a> * 8.0;
00166         }
00167 
00168         <span class="comment">/* Move camera backward by keypress. */</span>
00169         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_DOWN) || <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_S))
00170         {
00171             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.z = <a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a>;
00172         }
00173 
00174         <span class="comment">/* Move camera backward by mouse wheel. */</span>
00175         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;getMouseRelativeZ () &lt; 0)
00176         {
00177             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.z = <a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a> * 8.0;
00178         }
00179 
00180         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_PGUP))
00181         {
00182             <span class="comment">// Move camera up</span>
00183             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.y = <a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a>;
00184         }
00185 
00186         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_PGDOWN))
00187         {
00188             <span class="comment">// Move camera down</span>
00189             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.y = -<a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a>;
00190         }
00191 
00192         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_RIGHT))
00193         {
00194             <a class="code" href="classExampleFrameListener.html#p2">mCamera</a>-&gt;yaw (-<a class="code" href="classExampleFrameListener.html#p11">mRotScale</a>);
00195         }
00196 
00197         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_LEFT))
00198         {
00199             <a class="code" href="classExampleFrameListener.html#p2">mCamera</a>-&gt;yaw (<a class="code" href="classExampleFrameListener.html#p11">mRotScale</a>);
00200         }
00201 
00202         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_ESCAPE))
00203         {
00204             <span class="keywordflow">return</span> <span class="keyword">false</span>;
00205         }
00206 
00207         <span class="comment">// see if switching is on, and you want to toggle </span>
00208         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p8">mInputTypeSwitchingOn</a> &amp;&amp; <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_M) &amp;&amp; <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> &lt;= 0)
00209         {
00210             <a class="code" href="classExampleFrameListener.html#a8">switchMouseMode</a> ();
00211             <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> = 1;
00212         }
00213 
00214         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p8">mInputTypeSwitchingOn</a> &amp;&amp; <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_K) &amp;&amp; <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> &lt;= 0)
00215         {
00216             <span class="comment">// must be going from immediate keyboard to buffered keyboard</span>
00217             <a class="code" href="classExampleFrameListener.html#a9">switchKeyMode</a> ();
00218             <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> = 1;
00219         }
00220         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_F) &amp;&amp; <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> &lt;= 0)
00221         {
00222             <a class="code" href="classExampleFrameListener.html#p5">mStatsOn</a> = !<a class="code" href="classExampleFrameListener.html#p5">mStatsOn</a>;
00223             <a class="code" href="classExampleFrameListener.html#a5">showDebugOverlay</a> (<a class="code" href="classExampleFrameListener.html#p5">mStatsOn</a>);
00224 
00225             <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> = 1;
00226         }
00227         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_T) &amp;&amp; <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> &lt;= 0)
00228         {
00229             <span class="keywordflow">switch</span> (<a class="code" href="classExampleFrameListener.html#p15">mFiltering</a>)
00230             {
00231                 <span class="keywordflow">case</span> TFO_BILINEAR:
00232                     <a class="code" href="classExampleFrameListener.html#p15">mFiltering</a> = TFO_TRILINEAR;
00233                     <a class="code" href="classExampleFrameListener.html#p16">mAniso</a> = 1;
00234                     <span class="keywordflow">break</span>;
00235                 <span class="keywordflow">case</span> TFO_TRILINEAR:
00236                     <a class="code" href="classExampleFrameListener.html#p15">mFiltering</a> = TFO_ANISOTROPIC;
00237                     <a class="code" href="classExampleFrameListener.html#p16">mAniso</a> = 8;
00238                     <span class="keywordflow">break</span>;
00239                 <span class="keywordflow">case</span> TFO_ANISOTROPIC:
00240                     <a class="code" href="classExampleFrameListener.html#p15">mFiltering</a> = TFO_BILINEAR;
00241                     <a class="code" href="classExampleFrameListener.html#p16">mAniso</a> = 1;
00242                     <span class="keywordflow">break</span>;
00243             }
00244             MaterialManager::getSingleton ().setDefaultTextureFiltering (<a class="code" href="classExampleFrameListener.html#p15">mFiltering</a>);
00245             MaterialManager::getSingleton ().setDefaultAnisotropy (<a class="code" href="classExampleFrameListener.html#p16">mAniso</a>);
00246 
00247 
00248             <a class="code" href="classExampleFrameListener.html#a5">showDebugOverlay</a> (<a class="code" href="classExampleFrameListener.html#p5">mStatsOn</a>);
00249 
00250             <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> = 1;
00251         }
00252 
00253         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_SYSRQ) &amp;&amp; <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> &lt;= 0)
00254         {
00255             <span class="keywordtype">char</span> tmp[20];
00256 
00257             sprintf (tmp, <span class="stringliteral">"screenshot_%d.png"</span>, ++<a class="code" href="classExampleFrameListener.html#p9">mNumScreenShots</a>);
00258             <a class="code" href="classExampleFrameListener.html#p4">mWindow</a>-&gt;writeContentsToFile (tmp);
00259             <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> = 0.5;
00260             <a class="code" href="classExampleFrameListener.html#p4">mWindow</a>-&gt;setDebugText (String (<span class="stringliteral">"Wrote "</span>) + tmp);
00261         }
00262 
00263         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;isKeyDown (KC_R) &amp;&amp; <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> &lt;= 0)
00264         {
00265             <a class="code" href="classExampleFrameListener.html#r0">mSceneDetailIndex</a> = (<a class="code" href="classExampleFrameListener.html#r0">mSceneDetailIndex</a> + 1) % 3;
00266             <span class="keywordflow">switch</span> (<a class="code" href="classExampleFrameListener.html#r0">mSceneDetailIndex</a>)
00267             {
00268                 <span class="keywordflow">case</span> 0:
00269                     <a class="code" href="classExampleFrameListener.html#p2">mCamera</a>-&gt;setDetailLevel (SDL_SOLID);
00270                     <span class="keywordflow">break</span>;
00271                 <span class="keywordflow">case</span> 1:
00272                     <a class="code" href="classExampleFrameListener.html#p2">mCamera</a>-&gt;setDetailLevel (SDL_WIREFRAME);
00273                     <span class="keywordflow">break</span>;
00274                 <span class="keywordflow">case</span> 2:
00275                     <a class="code" href="classExampleFrameListener.html#p2">mCamera</a>-&gt;setDetailLevel (SDL_POINTS);
00276                     <span class="keywordflow">break</span>;
00277             }
00278             <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> = 0.5;
00279         }
00280 
00281 
00282 
00283         <span class="comment">// Return true to continue rendering</span>
00284         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00285     }
00286 
<a name="l00287"></a><a class="code" href="classExampleFrameListener.html#a3">00287</a>     <span class="keywordtype">bool</span> <a class="code" href="classExampleFrameListener.html#a3">processUnbufferedMouseInput</a> (<span class="keyword">const</span> FrameEvent &amp; evt)
00288     {
00289         <span class="comment">/* Rotation factors, may not be used if the second mouse button is pressed. */</span>
00290 
00291         <span class="comment">/* If the second mouse button is pressed, then the mouse movement results in </span>
00292 <span class="comment">           sliding the camera, otherwise we rotate. */</span>
00293         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;getMouseButton (1))
00294         {
00295             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.x += <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;getMouseRelativeX () * 0.13;
00296             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>.y -= <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;getMouseRelativeY () * 0.13;
00297         }
00298         <span class="keywordflow">else</span>
00299         {
00300             <a class="code" href="classExampleFrameListener.html#p13">mRotX</a> = -<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;getMouseRelativeX () * 0.13;
00301             <a class="code" href="classExampleFrameListener.html#p14">mRotY</a> = -<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;getMouseRelativeY () * 0.13;
00302         }
00303 
00304 
00305         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00306     }
00307 
<a name="l00308"></a><a class="code" href="classExampleFrameListener.html#a4">00308</a>     <span class="keywordtype">void</span> <a class="code" href="classExampleFrameListener.html#a4">moveCamera</a> ()
00309     {
00310 
00311         <span class="comment">// Make all the changes to the camera</span>
00312         <span class="comment">// Note that YAW direction is around a fixed axis (freelook style) rather than a natural YAW (e.g. airplane)</span>
00313         <a class="code" href="classExampleFrameListener.html#p2">mCamera</a>-&gt;yaw (<a class="code" href="classExampleFrameListener.html#p13">mRotX</a>);
00314         <a class="code" href="classExampleFrameListener.html#p2">mCamera</a>-&gt;pitch (<a class="code" href="classExampleFrameListener.html#p14">mRotY</a>);
00315         <a class="code" href="classExampleFrameListener.html#p2">mCamera</a>-&gt;moveRelative (<a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>);
00316 
00317 
00318     }
00319 
<a name="l00320"></a><a class="code" href="classExampleFrameListener.html#a5">00320</a>     <span class="keywordtype">void</span> <a class="code" href="classExampleFrameListener.html#a5">showDebugOverlay</a> (<span class="keywordtype">bool</span> show)
00321     {
00322         Overlay *o = (Overlay *) OverlayManager::getSingleton ().getByName (<span class="stringliteral">"Core/DebugOverlay"</span>);
00323 
00324         <span class="keywordflow">if</span> (!o)
00325             Except (Exception::ERR_ITEM_NOT_FOUND, <span class="stringliteral">"Could not find overlay Core/DebugOverlay"</span>, <span class="stringliteral">"showDebugOverlay"</span>);
00326         <span class="keywordflow">if</span> (show)
00327         {
00328             o-&gt;show ();
00329         }
00330         <span class="keywordflow">else</span>
00331         {
00332             o-&gt;hide ();
00333         }
00334     }
00335 
00336     <span class="comment">// Override frameStarted event to process that (don't care about frameEnded)</span>
<a name="l00337"></a><a class="code" href="classExampleFrameListener.html#a6">00337</a>     <span class="keywordtype">bool</span> <a class="code" href="classExampleFrameListener.html#a6">frameStarted</a> (<span class="keyword">const</span> FrameEvent &amp; evt)
00338     {
00339 
00340         <span class="keywordflow">if</span> (!<a class="code" href="classExampleFrameListener.html#p8">mInputTypeSwitchingOn</a>)
00341         {
00342             <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;capture ();
00343         }
00344 
00345 
00346         <span class="keywordflow">if</span> (!<a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a> || !<a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a>)
00347         {
00348             <span class="comment">// one of the input modes is immediate, so setup what is needed for immediate mouse/key movement</span>
00349             <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> &gt;= 0)
00350                 <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a> -= evt.timeSinceLastFrame;
00351 
00352             <span class="comment">// If this is the first frame, pick a speed</span>
00353             <span class="keywordflow">if</span> (evt.timeSinceLastFrame == 0)
00354             {
00355                 <a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a> = 1;
00356                 <a class="code" href="classExampleFrameListener.html#p11">mRotScale</a> = 0.1;
00357             }
00358             <span class="comment">// Otherwise scale movement units by time passed since last frame</span>
00359             <span class="keywordflow">else</span>
00360             {
00361                 <span class="comment">// Move about 100 units per second,</span>
00362                 <a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a> = 100.0 * evt.timeSinceLastFrame;
00363                 <span class="comment">// Take about 10 seconds for full rotation</span>
00364                 <a class="code" href="classExampleFrameListener.html#p11">mRotScale</a> = 36 * evt.timeSinceLastFrame;
00365             }
00366             <a class="code" href="classExampleFrameListener.html#p13">mRotX</a> = 0;
00367             <a class="code" href="classExampleFrameListener.html#p14">mRotY</a> = 0;
00368             <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a> = Vector3::ZERO;
00369         }
00370 
00371         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a>)
00372         {
00373             <span class="comment">// no need to do any processing here, it is handled by event processor and </span>
00374             <span class="comment">// you get the results as KeyEvents</span>
00375         }
00376         <span class="keywordflow">else</span>
00377         {
00378             <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#a2">processUnbufferedKeyInput</a> (evt) == <span class="keyword">false</span>)
00379             {
00380                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00381             }
00382         }
00383         <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a>)
00384         {
00385             <span class="comment">// no need to do any processing here, it is handled by event processor and </span>
00386             <span class="comment">// you get the results as MouseEvents</span>
00387         }
00388         <span class="keywordflow">else</span>
00389         {
00390             <span class="keywordflow">if</span> (<a class="code" href="classExampleFrameListener.html#a3">processUnbufferedMouseInput</a> (evt) == <span class="keyword">false</span>)
00391             {
00392                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00393             }
00394         }
00395 
00396         <span class="keywordflow">if</span> (!<a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a> || !<a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a>)
00397         {
00398             <span class="comment">// one of the input modes is immediate, so update the movement vector</span>
00399 
00400             <a class="code" href="classExampleFrameListener.html#a4">moveCamera</a> ();
00401 
00402         }
00403 
00404         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00405     }
00406 
<a name="l00407"></a><a class="code" href="classExampleFrameListener.html#a7">00407</a>     <span class="keywordtype">bool</span> <a class="code" href="classExampleFrameListener.html#a7">frameEnded</a> (<span class="keyword">const</span> FrameEvent &amp; evt)
00408     {
00409         <a class="code" href="classExampleFrameListener.html#d0">updateStats</a> ();
00410         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00411     }
00412 
<a name="l00413"></a><a class="code" href="classExampleFrameListener.html#a8">00413</a>     <span class="keywordtype">void</span> <a class="code" href="classExampleFrameListener.html#a8">switchMouseMode</a> ()
00414     {
00415         <a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a> = !<a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a>;
00416         <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;setBufferedInput (<a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a>, <a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a>);
00417     }
<a name="l00418"></a><a class="code" href="classExampleFrameListener.html#a9">00418</a>     <span class="keywordtype">void</span> <a class="code" href="classExampleFrameListener.html#a9">switchKeyMode</a> ()
00419     {
00420         <a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a> = !<a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a>;
00421         <a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>-&gt;setBufferedInput (<a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a>, <a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a>);
00422     }
00423 
<a name="l00424"></a><a class="code" href="classExampleFrameListener.html#a10">00424</a>     <span class="keywordtype">void</span> <a class="code" href="classExampleFrameListener.html#a10">keyClicked</a> (KeyEvent * e)
00425     {
00426         <span class="keywordflow">if</span> (e-&gt;getKeyChar () == <span class="charliteral">'m'</span>)
00427         {
00428             <a class="code" href="classExampleFrameListener.html#a8">switchMouseMode</a> ();
00429         }
00430         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e-&gt;getKeyChar () == <span class="charliteral">'k'</span>)
00431         {
00432 
00433             <a class="code" href="classExampleFrameListener.html#a9">switchKeyMode</a> ();
00434         }
00435 
00436     }
<a name="l00437"></a><a class="code" href="classExampleFrameListener.html#a11">00437</a>     <span class="keywordtype">void</span> <a class="code" href="classExampleFrameListener.html#a11">keyPressed</a> (KeyEvent * e)
00438     {
00439     }
<a name="l00440"></a><a class="code" href="classExampleFrameListener.html#a12">00440</a>     <span class="keywordtype">void</span> <a class="code" href="classExampleFrameListener.html#a12">keyReleased</a> (KeyEvent * e)
00441     {
00442     }
00443 
00444   <span class="keyword">protected</span>:
<a name="l00445"></a><a class="code" href="classExampleFrameListener.html#p0">00445</a>     EventProcessor * <a class="code" href="classExampleFrameListener.html#p0">mEventProcessor</a>;
<a name="l00446"></a><a class="code" href="classExampleFrameListener.html#p1">00446</a>     InputReader *<a class="code" href="classExampleFrameListener.html#p1">mInputDevice</a>;
<a name="l00447"></a><a class="code" href="classExampleFrameListener.html#p2">00447</a>     Camera *<a class="code" href="classExampleFrameListener.html#p2">mCamera</a>;
00448 
<a name="l00449"></a><a class="code" href="classExampleFrameListener.html#p3">00449</a>     Vector3 <a class="code" href="classExampleFrameListener.html#p3">mTranslateVector</a>;
<a name="l00450"></a><a class="code" href="classExampleFrameListener.html#p4">00450</a>     RenderWindow *<a class="code" href="classExampleFrameListener.html#p4">mWindow</a>;
<a name="l00451"></a><a class="code" href="classExampleFrameListener.html#p5">00451</a>     <span class="keywordtype">bool</span> <a class="code" href="classExampleFrameListener.html#p5">mStatsOn</a>;
<a name="l00452"></a><a class="code" href="classExampleFrameListener.html#p7">00452</a>     <span class="keywordtype">bool</span> <a class="code" href="classExampleFrameListener.html#p6">mUseBufferedInputKeys</a>, <a class="code" href="classExampleFrameListener.html#p7">mUseBufferedInputMouse</a>, <a class="code" href="classExampleFrameListener.html#p8">mInputTypeSwitchingOn</a>;
<a name="l00453"></a><a class="code" href="classExampleFrameListener.html#p9">00453</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classExampleFrameListener.html#p9">mNumScreenShots</a>;
<a name="l00454"></a><a class="code" href="classExampleFrameListener.html#p10">00454</a>     <span class="keywordtype">float</span> <a class="code" href="classExampleFrameListener.html#p10">mMoveScale</a>;
<a name="l00455"></a><a class="code" href="classExampleFrameListener.html#p11">00455</a>     <span class="keywordtype">float</span> <a class="code" href="classExampleFrameListener.html#p11">mRotScale</a>;
00456 
00457     <span class="comment">// just to stop toggles flipping too fast</span>
<a name="l00458"></a><a class="code" href="classExampleFrameListener.html#p12">00458</a>     Real <a class="code" href="classExampleFrameListener.html#p12">mTimeUntilNextToggle</a>;
<a name="l00459"></a><a class="code" href="classExampleFrameListener.html#p14">00459</a>     <span class="keywordtype">float</span> <a class="code" href="classExampleFrameListener.html#p13">mRotX</a>, <a class="code" href="classExampleFrameListener.html#p14">mRotY</a>;
<a name="l00460"></a><a class="code" href="classExampleFrameListener.html#p15">00460</a>     TextureFilterOptions <a class="code" href="classExampleFrameListener.html#p15">mFiltering</a>;
<a name="l00461"></a><a class="code" href="classExampleFrameListener.html#p16">00461</a>     <span class="keywordtype">int</span> <a class="code" href="classExampleFrameListener.html#p16">mAniso</a>;
00462 
00463 };
00464 
00465 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Apr 20 16:32:36 2004 for Motorsport by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
